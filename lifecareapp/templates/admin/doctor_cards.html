{% extends 'admin/base_admin.html' %}
{% load static %}

{% block content %}

<style>
    thead th {
        background-color: #00796b !important;
        color: white !important;
    }
</style>


<div class="container mt-5">
  <h2 class="text-2xl font-semibold mb-4" style="color: #00796b;">Doctor Profiles</h2>

  <!-- ðŸ” Search Bar -->
  <form method="GET" class="mb-4">
    <div class="input-group">
      <input type="text" id="doctorSearch" class="form-control border border-blue-300 rounded-start-2 p-2" placeholder="Search doctors...">
      <button class="btn" style="background-color: #00796b; color: white;" type="button">Search</button>
    </div>
  </form>

  <div class="table-responsive">
    <table id="doctorTable" class="table table-bordered table-hover shadow-sm bg-white rounded-3 overflow-hidden">
      <thead>
        <tr>
          <th>#</th>
          <th>Photo</th>
          <th>Name</th>
          <th>Title</th>
          <th>License</th>
          <th>Email</th>
          <th>Contact</th>
          <th>Location</th>
          <th>Charge</th>
          <th>Languages</th>
          <th>Expertise</th>
          <th>Qualifications</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for doctor in doctors %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>
            {% if doctor.profile_pic %}
              <img src="{{ doctor.profile_pic.url }}" alt="Profile" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover;">
            {% else %}
              <span class="text-muted">No Image</span>
            {% endif %}
          </td>
          <td>{{ doctor.full_name }}</td>
          <td>{{ doctor.professional_title }}</td>
          <td>{{ doctor.license_number }}</td>
          <td>{{ doctor.email }}</td>
          <td>{{ doctor.contact }}</td>
          <td>{{ doctor.available_location }}</td>
          <td>KES {{ doctor.charge_rates }}</td>
          <td style="white-space: pre-line;">{{ doctor.languages }}</td>
          <td style="white-space: pre-line;">{{ doctor.expertise }}</td>
          <td style="white-space: pre-line;">{{ doctor.qualifications }}</td>
          <td>
            <a href="{% url 'edit_doctor' doctor.pk %}" class="btn btn-sm" style="background-color: #00796b; color: white;">Edit</a><br>
            <a href="{% url 'delete_doctor' doctor.pk %}" class="btn btn-sm btn-danger mt-1">Delete</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="13" class="text-center text-muted">No matching doctors found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- ðŸ§  Simple client-side search logic -->
<script>
  document.getElementById("doctorSearch").addEventListener("keyup", function () {
    const input = this.value.toLowerCase();
    const rows = document.querySelectorAll("#doctorTable tbody tr");

    rows.forEach(row => {
      const rowText = row.textContent.toLowerCase();
      row.style.display = rowText.includes(input) ? "" : "none";
    });
  });
</script>
{% endblock %}
